{% extends 'base.html' %} {% load static %} {% block content %}
<style>
    .confirmation-wrapper {
        min-height: 70vh;
        padding: 40px 20px;
    }
    
    .confirmation-card {
        max-width: 900px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 15px 40px rgba(25, 135, 84, 0.1);
        overflow: hidden;
    }
    
    .confirmation-header {
        background: linear-gradient(135deg, #198754, #146c43);
        color: white;
        padding: 40px;
        text-align: center;
    }
    
    .confirmation-body {
        padding: 40px;
    }
    
    .whatsapp-btn {
        background: #25D366;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        text-decoration: none;
    }
    
    .whatsapp-btn:hover {
        background: #128C7E;
        color: white;
    }
</style>

<div class="confirmation-wrapper">
    <div class="confirmation-card">
        <!-- Header -->
        <div class="confirmation-header">
            <div style="font-size: 60px; margin-bottom: 20px;">âœ…</div>
            <h1 class="display-5 fw-bold mb-3">Package Booking Confirmed!</h1>
            <p class="lead mb-0">Thank you for choosing Pathan Tours & Travels</p>
        </div>

        <!-- Body -->
        <div class="confirmation-body">
            <div class="text-center mb-4">
                <h3>Hello, {{ booking.customer_name }}! ðŸ‘‹</h3>
                <p class="text-muted">Your package booking has been confirmed successfully</p>
            </div>

            <!-- Booking Details -->
            <div class="row">
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header bg-light">
                            <h5 class="mb-0">ðŸ“¦ Package Details</h5>
                        </div>
                        <div class="card-body">
                            <p><strong>Package:</strong> {{ booking.package.name }}</p>
                            <p><strong>Type:</strong> {{ booking.package.get_package_type_display }}</p>
                            <p><strong>Route:</strong> {{ booking.package.pickup_location }} â†’ {{ booking.package.drop_location }}</p>
                            <p><strong>Distance:</strong> {{ booking.package.distance_km }} KM</p>
                            <p><strong>Duration:</strong> {{ booking.package.duration_days }} Day(s)</p>
                            <p><strong>Vehicle:</strong> {{ booking.package.get_vehicle_type_display }}</p>
                            <p><strong>Passengers:</strong> {{ booking.passengers_count }}</p>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header bg-light">
                            <h5 class="mb-0">ðŸ’° Payment Summary</h5>
                        </div>
                        <div class="card-body">
                            <p><strong>Booking ID:</strong> {{ booking.invoice_no }}</p>

                            <!-- âœ… CHANGED: Use package schedule instead of booking date/time -->
                            {% if booking.package.scheduled_date %}
                            <p><strong>Scheduled Date:</strong> {{ booking.package.scheduled_date }}</p>
                            <p><strong>Scheduled Time:</strong> {{ booking.package.formatted_scheduled_time }}</p>
                            {% else %}
                            <p><strong>Schedule:</strong> <span class="text-warning">Will be confirmed by admin</span></p>
                            {% endif %}

                            <hr>
                            <p><strong>Total Fare:</strong> <span class="text-success">â‚¹{{ booking.total_amount }}</span></p>
                            <p><strong>Advance Paid:</strong> <span class="text-success">â‚¹{{ booking.advance_paid }}</span></p>
                            <p><strong>Remaining Amount:</strong> <span class="text-danger">â‚¹{{ booking.remaining_amount }}</span></p>
                            <p><strong>Status:</strong> <span class="badge bg-success">{{ booking.get_status_display }}</span></p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Package Inclusions -->
            <div class="card mb-4">
                <div class="card-header bg-light">
                    <h5 class="mb-0">âœ… Package Inclusions</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        {% for inclusion in booking.package.inclusions.split %}
                        <div class="col-md-6 mb-2">
                            <i class="fas fa-check text-success me-2"></i> {{ inclusion }}
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <!-- Important Notes -->
            {% if booking.package.important_notes %}
            <div class="alert alert-warning">
                <h5><i class="fas fa-exclamation-triangle me-2"></i> Important Notes</h5>
                {{ booking.package.important_notes|linebreaks }}
            </div>
            {% endif %}

            <!-- Action Buttons -->
            <div class="text-center mt-5">
                <div class="d-flex flex-wrap justify-content-center gap-3">
                    <a href="{% url 'package_invoice' booking.id %}" class="btn btn-success btn-lg">
                        <i class="fas fa-download me-2"></i> Download Invoice
                    </a>

                    <a href="{% url 'home' %}" class="btn btn-outline-success btn-lg">
                        <i class="fas fa-home me-2"></i> Back to Home
                    </a>

                    <a href="https://wa.me/919879230065?text=Hello%20Pathan%20Tours,%20I%20have%20booked%20package%20{{ booking.invoice_no }}" class="btn btn-lg whatsapp-btn" target="_blank">
                        <i class="fab fa-whatsapp me-2"></i> Chat on WhatsApp
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}